import{_ as n,c as a,a as e,o as t}from"./app-2MiBgEQI.js";const l={};function i(r,s){return t(),a("div",null,[...s[0]||(s[0]=[e(`<p>在使用爬虫库requests爬取页面时发生了&quot;dh key to small&quot;的错误，如下几种情况：</p><div class="language-text line-numbers-mode" data-highlighter="prismjs" data-ext="text" data-title="text"><pre><code><span class="line">requests.exceptions.SSLError: [SSL: SSL_NEGATIVE_LENGTH] dh key too small (_ssl.c:600)</span>
<span class="line">requests.exceptions.SSLError: HTTPSConnectionPool(host=&#39;cas.dgut.edu.cn&#39;, port=443): Max retries exceeded with url: ... (Caused by SSLError(SSLError(1, &#39;[SSL: DH_KEY_TOO_SMALL] dh key too small (_ssl.c:997)&#39;)))</span>
<span class="line">requests.exceptions.SSLError: HTTPSConnectionPool(host=&#39;somehost.com&#39;, port=443): Max retries exceeded with url: myurl (Caused by SSLError(SSLError(1, &#39;[SSL: WRONG_SIGNATURE_TYPE] wrong signature type (_ssl.c:1108)&#39;)))</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>简单分析了一下原因，最新版本的SSL默认不使用弱DH（DH：即Diffie-Hellman，密钥交换协议/算法），因此会报错。</p><p>解决思路也比较简单，主要两种：</p><ol><li>设置或添加默认值</li><li>回退版本</li></ol><p>第2种方法适合一些虚拟机、docker之类的，比如把ubuntu20.04改成ubuntu18.04。而在我们自己的主机环境下时，推荐在Python脚本中添加代码修改</p><ul><li>解决方案1：添加默认密码字符串</li></ul><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">import</span> requests</span>
<span class="line"></span>
<span class="line">requests<span class="token punctuation">.</span>packages<span class="token punctuation">.</span>urllib3<span class="token punctuation">.</span>util<span class="token punctuation">.</span>ssl_<span class="token punctuation">.</span>DEFAULT_CIPHERS <span class="token operator">+=</span> <span class="token string">&#39;:HIGH:!DH:!aNULL&#39;</span></span>
<span class="line"></span>
<span class="line"><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>解决方案2：降低SECLEVEL级别</li></ul><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py" data-title="py"><pre><code><span class="line"><span class="token keyword">import</span> requests</span>
<span class="line"></span>
<span class="line">requests<span class="token punctuation">.</span>packages<span class="token punctuation">.</span>urllib3<span class="token punctuation">.</span>util<span class="token punctuation">.</span>ssl_<span class="token punctuation">.</span>DEFAULT_CIPHERS <span class="token operator">=</span> <span class="token string">&#39;DEFAULT:@SECLEVEL=1&#39;</span></span>
<span class="line"></span>
<span class="line"><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,10)])])}const o=n(l,[["render",i]]),c=JSON.parse('{"path":"/blogs/Python/sslerror.html","title":"SSLError：dh key to small报错如何解决","lang":"zh-CN","frontmatter":{"title":"SSLError：dh key to small报错如何解决","date":"2022/07/28","tags":["爬虫","报错"],"categories":["Python"]},"headers":[],"git":{"createdTime":1764485360000,"updatedTime":1764485360000,"contributors":[{"name":"bertramoon","email":"bertramoon@126.com","commits":1}]},"filePathRelative":"blogs/Python/sslerror.md"}');export{o as comp,c as data};
